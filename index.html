<!DOCTYPE html>
<html lang="zh_Hant">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<link href="css/style.css" rel="stylesheet" type="text/css">
</head>

<body>
	<main class="weather_1" id="main_weather_id">
		<section class="main">
			<div class="weather_anime">
				<div class="wa_item wa_01">
					<img src="img/wa01_sun_02.png" id="wa01_sun_02">
					<img src="img/wa01_sun_01.png" id="wa01_sun_01">
					<img src="img/wa01_cloud_01.png" id="wa01_cloud_01">
					<img src="img/wa01_cloud_02.png" id="wa01_cloud_02">
					<img src="img/wa01_cloud_03.png" id="wa01_cloud_03">
				</div>
				<div class="wa_item wa_02">
					<img src="img/wa02_rain_01.png" id="wa02_rain_01">
					<img src="img/wa02_rain_02.png" id="wa02_rain_02">
					<img src="img/wa02_rain_01.png" id="wa02_rain_03">
					<img src="img/wa02_cloud_05.png" id="wa02_cloud_05">
					<img src="img/wa02_cloud_02.png" id="wa02_cloud_02">
					<img src="img/wa02_cloud_01.png" id="wa02_cloud_01">
					<img src="img/wa02_cloud_04.png" id="wa02_cloud_04">
					<img src="img/wa02_cloud_03.png" id="wa02_cloud_03">
				</div>
			</div>
			<div class="header">
				<div class="weather">
					<!-- <div class="weather_box">
						<div class="weather_img">
							<img src="img/weater_img01.png">
						</div>
						<div class="weather_text" id="weather_text_temperature" ></div>
					</div>
					<div class="weather_box">
						<div class="weather_img">
							<img src="img/west.png">
						</div>
						<div class="weather_text" id="weather_text_humidity" ></div>
					</div> -->
					<div class="floor_date">
						<div class="date" id="date_div"></div>
						<div class="time" id="time_div"></div>
					</div>
				</div>

				<div class="main_title">
					<h1>AIR QUALITY INDEX</h1>
					<h2>空氣品質監測</h2>
				</div>
				<div class="logo">
					<div class="logo_box">
						<img src="img/logo01.png">
					</div>
					<div class="logo_box">
						<img src="img/logo02.png">
					</div>
				</div>
			</div>
			<div class="main_frame flex" id="main_frame_div" >
			
			</div>
		</section>
		<section class="footer">
			<div class="flex flex-between">
				<div class="bar_chart" id="bar_chart_id">
				</div>
				<div class="floor_list">
					<div class="flex" id="floor_list_div">

					</div>
				</div>
			</div>
		</section>
	</main>
	<script src="js/jquery-3.6.0.min.js" type="text/javascript"></script>
	<script src="js/script.js" type="text/javascript"></script>
	<script>
		var number = 0;
		var time = new Date();
		var secondsRemaining = (60 - time.getSeconds()) * 1000;

		setTimeout(function () {
			setInterval(function () { getData(); }, 60000);
		}, secondsRemaining);

		$(function () {

			getData();

		});
		function getData() {
			number++;
			if(number==4)
			{
				number=0;
			}
			var para = {
				factory: 'F14P5',
				num: number
			};
			$.ajax({
				url: 'https://220.135.61.4/PUSD_com1/aspx/getAirQualityData.aspx',
				data: para,
				async: false,
				success: res => {
					console.log(res.Rain);
					if(res.Rain===true)
					{
						$("#main_weather_id").attr('class', 'weather_2');

					}else
					{

						$("#main_weather_id").attr('class', 'weather_1');
					}
					$("#weather_text_temperature").html(res.Temperature + '℃');
					$("#weather_text_humidity").html(res.Humidity + '%');
					$("#date_div").html(res.Date);
					$("#time_div").html(res.Time);
					$("#floor_list_div").html(res.RealTimePoints);
					console.log(res.AirQualityPointsList);
					$("#bar_chart_id").html(res.IndicatorLegend);
					$("#main_frame_div").html(res.AirQualityPointsList);
				},
				error: res => {
					console.log('取得資料失敗！ failed');
				}
			});

		}
	</script>
</body>

</html>